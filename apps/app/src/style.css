:root{
  /* Theme */
  --gold: #ffd36a;
  --gold2: #ffb200;
  --gold3: #fff1b0;
  --goldGlow1: rgba(255, 210, 90, 0.65);
  --goldGlow2: rgba(255, 170, 0, 0.55);

  --mystic: #9b5cff;
  --mysticGlow: rgba(155,92,255,0.70);

  /* Wheel sizing (MUST match JS ITEM_H) */
  --rowH: 48px;
  --visibleRows: 3;
  --padRows: 1;

  /* Layout */
  --panelW: min(92vw, 320px);
  --gap: 12px;
}

*{ margin:0; padding:0; box-sizing:border-box; }

html, body{
  width:100%;
  height:100%;
  overflow:hidden;
  background:#0a0a12;
  color:#fff;
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

#app{
  width: 100vw;
  height: 100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* ============================================================
   PICKER SCREEN (Rabbit R1 safe)
   ============================================================ */

.picker-screen{
  width: 100vw;
  height: 100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  padding: 16px 0 14px;
  gap: 10px;
}

/* Title + heading */
.picker-title{
  font-size: 18px;
  line-height: 1;
  margin-top: 6px;
  filter: drop-shadow(0 0 6px rgba(155,92,255,0.55));
}

.picker-heading{
  font-size: 28px;
  letter-spacing: 10px;
  margin-left: 10px; /* visually centers letter-spacing */
  color: var(--gold);
  text-shadow: 0 0 15px rgba(255, 210, 90, 0.35);
  margin-bottom: 6px;
}

/* Two columns */
.picker-cols{
  width: var(--panelW);
  flex: 1;
  min-height: 0;
  display: grid;
  grid-template-columns: 1.6fr 0.8fr;
  gap: var(--gap);
  align-items: stretch;
}

.picker-col{
  min-height: 0;
  display:flex;
  flex-direction:column;
  align-items:stretch;
}

.picker-label{
  font-size: 12px;
  letter-spacing: 7px;
  margin: 0 0 6px 6px;
  text-transform: uppercase;
  font-weight: 800;
  color: var(--mystic);
  text-shadow: 0 0 10px var(--mysticGlow), 0 0 2px rgba(0,0,0,0.85);
}

/* Wheel container */
.wheel-mask{
  position: relative;
  width: 100%;
  height: calc(var(--rowH) * var(--visibleRows)); /* 3 rows */
  overflow: hidden;
  border-radius: 18px;
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.06);
}

/* top/bottom fade */
.wheel-mask::before,
.wheel-mask::after{
  content:'';
  position:absolute;
  left:0; right:0;
  height: calc(var(--rowH) * var(--padRows)); /* 1 row */
  z-index: 2;
  pointer-events:none;
}
.wheel-mask::before{
  top:0;
  background: linear-gradient(to bottom, #0a0a12 0%, rgba(10,10,18,0) 100%);
}
.wheel-mask::after{
  bottom:0;
  background: linear-gradient(to top, #0a0a12 0%, rgba(10,10,18,0) 100%);
}

/* Highlight = middle row */
.wheel-highlight{
  position:absolute;
  top: calc(var(--rowH) * var(--padRows)); /* exactly row 2 */
  left: 6%;
  right: 6%;
  height: var(--rowH);
  border-radius: 14px;
  z-index: 1;
  pointer-events:none;

  border: 1.5px solid rgba(255, 210, 90, 0.75);
  background: rgba(255, 210, 90, 0.08);
  box-shadow:
    0 0 18px rgba(255, 210, 90, 0.30),
    0 0 30px rgba(255, 170, 0, 0.20),
    inset 0 0 2px rgba(255, 241, 176, 0.55);
}

/* Scroll area */
.wheel-scroll{
  width:100%;
  height:100%;
  overflow-y:auto;
  scroll-snap-type:y mandatory;
  -webkit-overflow-scrolling:touch;
  scrollbar-width:none;
}
.wheel-scroll::-webkit-scrollbar{ display:none; }

/* padding above/below (1 row each) */
.wheel-pad{
  height: calc(var(--rowH) * var(--padRows));
  flex-shrink: 0;
}

/* items */
.wheel-item{
  height: var(--rowH);
  display:flex;
  align-items:center;
  gap: 10px;
  padding: 0 12px;
  scroll-snap-align:center;
  cursor:pointer;
  -webkit-tap-highlight-color: transparent;

  /* reduce twitch/blink */
  transform: translateZ(0);
  backface-visibility: hidden;
  will-change: transform, opacity;
}

.wheel-thumb{
  width: 28px;
  height: 28px;
  border-radius: 7px;
  object-fit: cover;
  background: #1a1a2e;
  flex-shrink: 0;
}

.wheel-text{
  font-size: 14px;
  font-weight: 800;
  color: #f0e6d0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  -webkit-font-smoothing: antialiased;
}

.wheel-item-count{ justify-content:center; }

.wheel-num{
  font-size: 16px;
  font-weight: 900;
  color: #f0e6d0;
  -webkit-font-smoothing: antialiased;
}

/* Start button (always visible, never overlaps wheels) */
.btn-start{
  width: var(--panelW);
  height: 56px;
  border-radius: 16px;
  border: none;
  cursor: pointer;
  flex-shrink: 0;

  font-size: 16px;
  font-weight: 900;
  letter-spacing: 6px;

  background: linear-gradient(135deg, var(--gold3), var(--gold2));
  color: #0a0a12;
  box-shadow:
    0 12px 30px rgba(0,0,0,0.45),
    0 0 18px rgba(255, 210, 90, 0.35);
}

.btn-start:active{
  opacity: 0.92;
  transform: scale(0.98);
}

/* ============================================================
   SHUFFLE ANIMATION (no text, cards only)
   ============================================================ */
.shuffling {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100vh;
  width: 100vw;
}

.shuffle-cards {
  position: relative;
  width: 50vw;
  height: 35vh;
}

.scard {
  position: absolute;
  width: 18vw;
  height: 28vw;
  border-radius: 2vw;
  border: 1.5px solid #d4af37;
  background: linear-gradient(135deg, #1a1a2e, #16213e);
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.5);
  left: 50%;
  top: 50%;
  transform-origin: center center;
}

.scard::after {
  content: '✦';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 5vw;
  color: rgba(212, 175, 55, 0.5);
}

.s1 { animation: shuffleCard1 0.7s ease-in-out 2; }
.s2 { animation: shuffleCard2 0.7s ease-in-out 2; animation-delay: 0.08s; }
.s3 { animation: shuffleCard3 0.7s ease-in-out 2; animation-delay: 0.16s; }
.s4 { animation: shuffleCard4 0.7s ease-in-out 2; animation-delay: 0.24s; }
.s5 { animation: shuffleCard5 0.7s ease-in-out 2; animation-delay: 0.32s; }

@keyframes shuffleCard1 {
  0%   { transform: translate(-50%, -50%) rotate(-12deg) translateX(-14vw); }
  50%  { transform: translate(-50%, -50%) rotate(8deg) translateX(10vw) translateY(-4vh); }
  100% { transform: translate(-50%, -50%) rotate(-12deg) translateX(-14vw); }
}

@keyframes shuffleCard2 {
  0%   { transform: translate(-50%, -50%) rotate(-6deg) translateX(-7vw); }
  50%  { transform: translate(-50%, -50%) rotate(12deg) translateX(6vw) translateY(-6vh); }
  100% { transform: translate(-50%, -50%) rotate(-6deg) translateX(-7vw); }
}

@keyframes shuffleCard3 {
  0%   { transform: translate(-50%, -50%) rotate(0deg); }
  50%  { transform: translate(-50%, -50%) rotate(0deg) translateY(-8vh) scale(1.08); }
  100% { transform: translate(-50%, -50%) rotate(0deg); }
}

@keyframes shuffleCard4 {
  0%   { transform: translate(-50%, -50%) rotate(6deg) translateX(7vw); }
  50%  { transform: translate(-50%, -50%) rotate(-12deg) translateX(-6vw) translateY(-6vh); }
  100% { transform: translate(-50%, -50%) rotate(6deg) translateX(7vw); }
}

@keyframes shuffleCard5 {
  0%   { transform: translate(-50%, -50%) rotate(12deg) translateX(14vw); }
  50%  { transform: translate(-50%, -50%) rotate(-8deg) translateX(-10vw) translateY(-4vh); }
  100% { transform: translate(-50%, -50%) rotate(12deg) translateX(14vw); }
}

/* ============================================================
   FACE-DOWN GRID
   ============================================================ */
.grid-screen {
  display: flex;
  flex-direction: column;
  align-items: center;
  height: 100vh;
  width: 100vw;
  padding: 1.5vh 2vw 1vh;
}

.grid-header {
  display: flex;
  justify-content: space-between;
  width: 100%;
  padding: 0 2vw;
  margin-bottom: 1vh;
}

.grid-status {
  font-size: 3.2vw;
  color: #d4af37;
  font-weight: 600;
}

.grid-count {
  font-size: 3.2vw;
  color: #888;
}

.grid-wrap {
  flex: 1;
  width: 100%;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.grid-wrap::-webkit-scrollbar {
  display: none;
}

.grid {
  display: grid;
  grid-template-columns: repeat(9, 1fr);
  gap: 1vw;
  padding: 0 1vw 1vh;
}

.grid-card{
  aspect-ratio: 2/3;
  border-radius: 1.2vw;
  border: 1px solid #d4af37;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  transition: all 0.2s ease;
  position: relative;

  /* NEW: show deck back art */
  background-color: #111126;
  background-repeat: no-repeat;
  background-position: center;
  background-size: contain; /* <-- key: thumbnail, not zoom-crop */
}

.grid-card::after {
  content: '✦';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 2.5vw;
  color: rgba(212, 175, 55, 0.4);
}

.grid-card:active {
  transform: scale(0.9);
}

.grid-card.picked {
  background: rgba(212, 175, 55, 0.2);
  border-color: #d4af37;
  box-shadow: 0 0 8px rgba(212, 175, 55, 0.4);
  pointer-events: none;
}

.grid-card.picked::after {
  content: '✓';
  color: #d4af37;
  font-size: 3vw;
  font-weight: 700;
}

.grid-card.just-picked {
  animation: pickFlash 0.4s ease;
}

@keyframes pickFlash {
  0% { transform: scale(1); }
  30% { transform: scale(1.15); box-shadow: 0 0 14px rgba(212, 175, 55, 0.6); }
  100% { transform: scale(1); }
}

.grid-hint {
  font-size: 3vw;
  color: #666;
  padding: 1vh 0;
  flex-shrink: 0;
}

/* ============================================================
   SPREAD VIEW
   ============================================================ */
.spread-screen {
  display: flex;
  flex-direction: column;
  align-items: center;
  height: 100vh;
  width: 100vw;
  padding: 1.5vh 3vw 1vh;
}

.spread-header {
  width: 100%;
  margin-bottom: 1.5vh;
}

.spread-title {
  font-size: 3.2vw;
  color: #d4af37;
  font-weight: 600;
  letter-spacing: 0.3vw;
}

.spread-area::-webkit-scrollbar{ display:none; }

/* Card tile uses the cell size, image decides its own ratio */


  /* critical: allow height to be driven by image */

.spread-symbol {
  font-size: 10vw;
}

.spread-label {
  position: absolute;
  bottom: 0.5vh;
  right: 1.5vw;
  font-size: 3vw;
  color: #e74c3c;
  font-weight: 900;
  Opacity: 0.95;
}

.spread-nav{
  flex-shrink: 0;
  position: sticky;
  bottom: 0;
  background: #0a0a12;
  align-content: center;
}

/* Spread area: row-based layout */
.spread-area{
  flex: 1;
  width: auto;
  display: flex;
  flex-direction: column;
  gap: 2vw;
}

/* 1–4 cards: center vertically */
.spread-area.single{
  justify-content: center;
  overflow: hidden;
}

/* 5+ cards: scrolling allowed */
.spread-area.scrolling{
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding-bottom: 1vh;
}
.spread-area.scrolling::-webkit-scrollbar{ display:none; }

/* Row templates */
.spread-row{
  width: auto;
  display: grid;
  gap: 2vw;
  justify-content: center;  /* centers rows that are narrower than full width */
}

.spread-row.cols-1{
  grid-template-columns: minmax(0, 1fr);
  max-width: 62vw;     /* makes 1 card nicely centered */
  margin: 0 auto;
}

.spread-row.cols-2{
  grid-template-columns: repeat(2, minmax(0, 1fr));
  max-width: 92vw;     /* keeps 2 cards centered */
  margin: 0 auto;
}

.spread-row.cols-3{
  grid-template-columns: repeat(3, minmax(0, 1fr));
}

.spread-row.cols-4{
  grid-template-columns: repeat(4, minmax(0, 1fr));
}

/* Card tile: let image keep its own aspect ratio (not forced 2:3) */
.spread-card{
  border-radius: 2.5vw;
  border: 5px solid var(--gold);
  box-shadow: 0 0 10px rgba(0,0,0,0.35), 0 0 10px var(--goldGlow);
  overflow: hidden;
  background: rgba(255,255,255,0.03);
  box-shadow: 0 0 10px rgba(212,175,55,0.12);
  position: relative;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* Upright = glowing gold */
.spread-card{
  border: 1.5px solid var(--gold);
  box-shadow:
    0 0 10px rgba(0,0,0,0.35),
    0 0 10px var(--goldGlow1),
    0 0 18px var(--goldGlow2),
    0 0 2px rgba(255, 241, 176, 0.55) inset;
}

/* Reversed = mysterious purple */
.spread-card.reversed{
  border: 1.5px solid var(--mystic);
  box-shadow:
    0 0 10px rgba(0,0,0,0.35),
    0 0 10px var(--mysticGlow),
    0 0 18px rgba(93,43,255,0.55),
    0 0 2px var(--mysticEdge) inset;
}

/* Image keeps true ratio and shrinks as needed */
.spread-img{
  width: 100%;
  height: auto;
  max-height: 50vh;          /* 1–4 cards look big */
  object-fit: contain;
  display: block;
}

/* In scrolling mode, shrink a bit so more fits per screen */
.spread-area.scrolling .spread-img{
  max-height: 45vh;
}

/* Keep reverse rotation */
.spread-card.reversed .spread-img,
.spread-card.reversed .spread-symbol{
  transform: rotate(180deg);
}


.spread-label{
  position:absolute;
  bottom:0.6vh;
  right:1.6vw;
  font-size:3.1vw;
  font-weight:900;
  opacity:0.95;
}

.spread-card.reversed .spread-label{
  color: var(--mystic);
  text-shadow:
    0 0 2px rgba(0,0,0,0.90),
    0 0 6px var(--mysticEdge),
    0 0 16px var(--mysticGlow),
    0 0 28px rgba(93,43,255,0.55);
}
/* Keep nav visible */
.spread-nav{
  flex-shrink: 0;
  position: sticky;
  bottom: 0;
  background: #0a0a12;

  display: flex;              /* important */
  flex-direction: column;
  align-items: center;        /* centers horizontally */
  justify-content: center;

  gap: 1vh;
  width: 100%;
  padding: 1vh 0 1.5vh;
}

.link-btn {
  background: none;
  border: none;
  color: #888;
  font-size: 3vw;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  padding: 1vw 2vw;
  min-height: 44px;
  display: flex;
  align-items: center;
}

.link-btn:active {
  color: #d4af37;
}

/* ============================================================
   CARD DETAIL VIEW
   ============================================================ */
.card-view {
  display: flex;
  flex-direction: column;
  align-items: center;
  height: 100vh;
  width: 100vw;
  padding: 1.5vh 4vw 1vh;
}

.card-header {
  display: flex;
  justify-content: space-between;
  width: 100%;
  font-size: 3vw;
  color: #666;
  margin-bottom: 1vh;
}

.card-count {
  color: #d4af37;
  font-weight: 600;
}

.card-type {
  color: #888;
  font-style: italic;
}

.card-frame {
  width: min(25vw, 420px);
  aspect-ratio: 4 / 9;      /* ✅ tarot card ratio */
  height: auto;             /* ✅ let aspect-ratio control height */
  max-height: 60vh;

  border-radius: 3vw;
  border: 1.5px solid var(--gold);
  box-shadow:
    0 0 10px rgba(0,0,0,0.35),
    0 0 10px var(--goldGlow1),
    0 0 18px var(--goldGlow2),
    0 0 2px rgba(255, 241, 176, 0.55) inset;
  overflow: hidden;
  background: #0a0a12;      /* letterbox background */


  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}


/* Upright = glowing gold (strong + colorful) */
.card-frame.up{
  border-color: var(--gold);
  box-shadow:
    0 0 20px rgba(0,0,0,0.35),
    0 0 14px var(--goldGlow1),
    0 0 26px var(--goldGlow2),
    0 0 2px rgba(255, 241, 176, 0.55) inset;
}

/* Reversed = mysterious purple glow */
.card-frame.rev{
  border-color: var(--mystic);
  box-shadow:
    0 0 20px rgba(0,0,0,0.35),
    0 0 16px var(--mysticGlow),
    0 0 32px rgba(93,43,255,0.55),
    0 0 3px var(--mysticEdge) inset;
}

.card-img-wrap {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 0.3s ease;
}

.card-img-wrap.reversed {
  transform: rotate(180deg);
}

.card-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

.card-symbol-wrap {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  transition: transform 0.3s ease;
}

.card-symbol-wrap.reversed {
  transform: rotate(180deg);
}

.card-big-symbol {
  font-size: 20vw;
  filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.3));
}

.card-fallback {
  font-size: 4.5vw;
  color: #d4af37;
  text-align: center;
  padding: 4vw;
  font-weight: 600;
  line-height: 2;
}

.card-info {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1vh;
  margin-top: 1vh;
  flex-shrink: 0;
}

.card-name {
  font-size: 4.5vw;
  font-weight: 600;
  text-align: center;
  color: #f0e6d0;
  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.5);
  line-height: 1.2;
}



.card-orientation{
  font-size: 2vw;
  font-weight: 800;
  letter-spacing: 0.2vw;
  padding: 0.6vw 2vw;
  border-radius: 4vw;
  border: 1px solid transparent;
}

/* Upright = glowing gold */
.card-orientation.up{
  color: var(--gold);
  border: 1.5px solid var(--gold);
  box-shadow:
    0 0 20px rgba(0,0,0,0.35),
    0 0 14px var(--goldGlow1),
    0 0 26px var(--goldGlow2),
    0 0 2px rgba(255, 241, 176, 0.55) inset;
  text-shadow:
    0 0 2px rgba(0,0,0,0.85),
    0 0 8px var(--goldGlow1);
  background: rgba(212,175,55,0.10);
  border-color: rgba(212,175,55,0.55);
}

/* Reversed = mysterious purple glow */
.card-orientation.rev{
  color: var(--mystic);
  background: rgba(155,92,255,0.12);
  border-color: rgba(155,92,255,0.65);
  box-shadow:
    0 0 12px var(--mysticGlow),
    0 0 2px var(--mysticEdge) inset;
  text-shadow:
    0 0 2px rgba(0,0,0,0.85),
    0 0 8px var(--mysticGlow);
}

/* Navigation */
.card-nav {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4vw;
  margin-top: auto;
  padding-bottom: 1.5vh;
  width: 100%;
  flex-shrink: 0;
}

.nav-btn {
  min-width: 30px;
  min-height: 30px;
  width: 10vw;
  height: 10vw;
  border-radius: 50%;
  border: 3px solid #444;
  background: #1a1a2e;
  color: #d4af37;
  font-size: 4.5vw;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  padding: 0;
}
.nav-btn.up {
 color: var(--gold)
}

.nav-btn.rev {
 color: var(--mystic)
}

.nav-btn.rev:active {
  background: var(--mystic);
  transform: scale(0.92);
}

.nav-btn:disabled {
  opacity: 0.25;
  pointer-events: none;
}

.nav-btn.rev.reshuffle {
  font-size: 5.5vw;
  border-color: rgba(155,92,255,0.65);
  box-shadow:
    0 0 20px rgba(0,0,0,0.35),
    0 0 16px var(--mysticGlow),
    0 0 32px rgba(93,43,255,0.55),
    0 0 3px var(--mysticEdge) inset;

  background: rgba(212, 175, 55, 0.1);
}

.nav-btn.up.reshuffle {
  font-size: 5.5vw;
  border-color: #d4af37;
  box-shadow:
    0 0 20px rgba(0,0,0,0.35),
    0 0 14px var(--goldGlow1),
    0 0 26px var(--goldGlow2),
    0 0 2px rgba(255, 241, 176, 0.55) inset;
  background: rgba(212, 175, 55, 0.1);
}


.nav-btn.reshuffle:active {
  background: rgba(212, 175, 55, 0.25);
}

.nav-btn.home-btn {
  font-size: 6vw;
  border-color: #666;
  align-items: center;
  display: flex;
}

/* ============================================================
   Rabbit R1 picker-only override (safe)
   Paste at END of style.css
   ============================================================ */

/* R1 screen is short: keep the SAME UI, just make it fit */
@media (max-height: 520px), (max-width: 420px) {

  .picker-screen{
    padding: 1.5vh 3vw 1.5vh; /* slightly tighter */
  }

  /* Title/heading slightly smaller so wheels + button fit */
  .picker-title{
    font-size: 6vw;
    margin-bottom: 0.2vh;
  }

  .picker-heading{
    font-size: 6vw;
    letter-spacing: 3vw;
    margin-bottom: 1vh;
  }

  /* Let the wheel area shrink and scroll internally if needed */
  .picker-cols{
    flex: 1;
    min-height: 0;          /* CRITICAL: allows children to shrink */
  }

  .picker-col{
    min-height: 0;          /* CRITICAL */
  }

  /* This is the main fix: wheel height becomes responsive */
  .wheel-mask{
    height: min(240px, 40vh);
  }

  /* Keep the Start button always visible at bottom */
  .btn-start{
    margin-top: auto;       /* pushes button down */
    margin-bottom: max(1vh, env(safe-area-inset-bottom));
    padding: 2.2vw 10vw;
    font-size: 4vw;
  }
}
